# AgentSystem 主指南

**版本**: v2.0
**说明**: 基于三篇文章方法论构建的永续AI工作系统，核心聚焦金融监管政策与支付行业领域

---

## 系统设计原则

### 原则1：按业务流程分类

```
正确的分类方式：
01-技能库/         # 各种AI技能
02-知识库/         # 领域知识
03-记忆库/         # 三层记忆系统
04-本体画像/       # 身份系统
05-任务系统/       # 任务管理
06-日记/           # 日记月记
07-工作流/         # 标准化流程
```

### 原则2：共享层 + 独立板块

```
AgentSystem/
├── 共享层（基础设施）
│   ├── CLAUDE.md         # AI总指南
│   ├── 本体画像/         # 身份系统
│   ├── 记忆库/          # 三层记忆
│   └── 任务系统/        # 任务追踪
│
├── 独立板块（业务线）
│   ├── 技能库/           # 9个AI技能
│   ├── 知识库/          # 7个知识库
│   └── 工作流/          # 标准化流程
```

### 原则3：系统会自己进化

- 每次完成任务后执行八步迭代
- 记忆自动沉淀为语义知识
- 外部输入自动提取转化为行动
- Git版本控制追踪所有改动

---

## 称呼规则（必须遵守）

- **每次回复时，必须在开头使用 "✓" 符号**
- 这是指令遵循度的标志
- 如果回复没有 "✓" 符号，说明上下文已过载，需要重开会话

---

## 上下文管理

### 懒加载策略

- ❌ 不要自动读取所有文件
- ✅ 只在用户明确需要时才读取相关文件
- ✅ 优先使用已有的上下文信息
- ✅ 使用 limit 参数限制行数

### 上下文使用阈值

- 超过 **40%**：指令遵循度开始下降
- 超过 **60%**：**必须**提醒用户重开会话
- 每次会话结束记录上下文使用情况

### 会话边界管理

- 复杂任务拆分成多个会话
- 每个会话聚焦一个主题
- 上下文过载时建议重开

---

## 技能路由机制（自动调用）

**位置**：`工作流/技能路由.md`

### 工作方式

用户描述需求 → AI自动判断 → 调用对应技能

### 路由示例

| 用户需求 | 自动调用 |
|---------|---------|
| "帮我分析支付监管条例" | policy-pbc |
| "了解一下支付基础知识" | policy-pbc-basics |
| "帮我做个Excel表格" | minimax-xlsx |
| "做个PPT" | mckinsey-ppt |

### 强制规则

- 技能路由**自动执行**，无需用户指定触发词
- 无法判断时先询问用户

---

## /done 技能（会话结束自动执行）

**位置**：`工作流/done技能.md`

### 触发条件

- 用户说"结束"、"完成"、"再见"
- 用户说"/done"
- 上下文超过60%需要重开
- 任务标记为完成

### 自动执行

1. **提取关键信息**：用户需求、关键讨论点、决策、产出
2. **生成情景记忆**：保存到 `记忆库/情景记忆/`
3. **更新对话历史**：保存到 `日志/对话历史.md`
4. **检查后续任务**：询问是否添加到任务清单

### 输出示例

```
✓ 检测到会话结束信号
正在生成情景记忆...
✓ 已保存到：记忆库/情景记忆/2026-02/0224-政策分析.md
✓ 对话历史已更新
✓ 后续任务已添加到任务清单

本次会话完成！是否需要执行系统迭代？
```

---

## 任务自动追踪

**位置**：`任务系统/任务清单.md`

### 时间意图自动捕获

当用户说以下词汇时，**自动**创建任务：

| 触发词 | 自动添加 |
|--------|---------|
| 明天 | 紧急重要 |
| 后天 | 重要不紧急 |
| 下周 | 重要不紧急 |
| 记得 | 重要不紧急 |
| 别忘了 | 重要不紧急 |
| 计划 | 日常事项 |

### 自动添加流程

```
用户输入 → 检测时间意图 → 解析任务内容
     ↓
判断优先级 → 创建任务 → 更新任务清单
     ↓
晨间简报显示
```

### 发布状态自动更新

当用户说"已发布"，自动：
1. 标记任务为已完成
2. 移动到归档

---

## 晨间简报

**位置**：`工作流/晨间简报.md`

### 触发

- 进入AgentSystem目录
- 用户说"简报"、"晨报"
- 每次新会话开始

### 自动执行

1. 检查今日待办
2. 检查已过期任务
3. 生成简报
4. 展示给用户

### 输出示例

```
🌅 晨间简报 | 2026-02-24

📋 今日待办：
【紧急重要】
- [ ] 完成政策分析报告

📊 统计：共1项待办

❓ 你想从哪个任务开始？
```

---

## 八步自我迭代流程

**位置**：`工作流/自动迭代触发.md`

### 触发条件

- 完成架构级改动
- 学习了新的方法论
- 解决了复杂问题
- 每周日定期迭代
- 用户说"执行迭代"

### 执行流程

1. **观察**：回顾任务过程
2. **分析**：发现问题和新模式
3. **设计**：提出解决方案
4. **实施**：更新系统文件
5. **验证**：检查逻辑一致性（含质量评分）
6. **记录**：创建情景记忆
7. **提炼**：更新语义记忆
8. **提交**：Git commit

### 质量评分

| 分数 | 行动 |
|------|------|
| 9-10分 | 直接提交 |
| 7-8分 | 可以提交 |
| <7分 | 重新设计 |

### 输出示例

```
=== 系统迭代完成 ===

📊 质量评分：8/10

📝 改进内容：
- 优化了技能路由规则

🔖 Git提交：iteration: 优化技能路由

✓ 系统已自动优化
```

---

## 智能存储路由

**位置**：`记忆库/强制规则/强制规则_智能存储路由.md`

### 自动执行

每次创建文件时：
1. 识别内容类型
2. 查询存储规则
3. 构建完整路径
4. 验证合规性
5. 执行存储
6. **告知用户保存位置**

### 存储路径

| 内容类型 | 路径 |
|---------|------|
| 政策简报 | /Volumes/Luis_MacData/Documents/trabajo/ |
| 情景记忆 | 记忆库/情景记忆/ |
| 语义记忆 | 记忆库/语义记忆/ |
| 日记 | 日记/ |
| 任务归档 | 任务归档/ |

### 工作区边界

- 所有文件**必须**在AgentSystem内
- 政策简报例外（用户明确需求）

---

## 本体画像系统（TELOS模块化）

**位置**：`本体画像/`

| 文件 | 用途 | 加载规则 |
|------|------|----------|
| 00-核心身份.md | 我是谁 | 每次必读（500字内）|
| 01-价值观与原则.md | 我相信什么 | 按需 |
| 02-背景与经历.md | 我的历史 | 按需 |
| 03-技能与能力.md | 我会什么 | 按需 |
| 05-目标与规划.md | 我要去哪 | 按需 |
| 07-工作方式.md | 我怎么工作 | 按需 |
| 08-关系网络.md | 我认识谁 | 按需 |

---

## 记忆库三层架构

**位置**：`记忆库/`

```
记忆库/
├── 情景记忆/      # 具体事件（按月归档）
├── 语义记忆/      # 提炼的知识
└── 强制规则/      # 系统行为约束
```

### 记忆提炼

- 触发：每次/done、每次迭代
- 流程：情景 → 语义 → 强制规则

### 外部知识吸收

- 触发：收到文章/推文/GitHub项目
- 流程：提取 → 对比 → 转化 → 记录

---

## Git版本控制

**位置**：`工作流/Git版本控制.md`

### 自动提交

- /done 执行时
- 系统迭代完成后
- 重要文件修改后

### 提交格式

```
git commit -m "type: description"
```

---

## 决策确认约束

### 必须询问用户

- 不确定的架构设计
- 可能影响系统的改动
- 有多种实现方案
- 涉及删除或重大重构

### 可以自主决策

- 明确的任务执行
- 遵循已有规则的操作
- 创建新文件
- 日常记录追踪

---

## 数据治理

**核心原则**：数据不删除，只转移

- 年终总结需要统计数据
- 复盘需要历史数据
- 数据是复利资产

---

## 版本记录

- v2.0: 整合自动化功能（技能路由、/done、任务自动追踪、Git版本控制、晨间简报）
- v1.0: 初版系统
