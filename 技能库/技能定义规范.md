# 技能定义规范

**版本**: v1.0
**说明**: 借鉴 Claude Code .ascl 格式设计理念，为 AgentSystem 技能定义标准元数据格式

---

## 设计原则

1. **向前兼容**：现有 Markdown 格式仍然有效
2. **渐进增强**：YAML front-matter 作为可选扩展
3. **结构化**：便于程序解析和处理

---

## 文件格式

### 完整示例

```yaml
---
skill:
  name: policy-pbc
  version: 1.28
  description: 央行政策决策参谋Agent，专注于金融监管政策与支付行业领域

triggers:
  - 分析政策
  - 监管动态
  - 支付行业
  - 央行文件
  - 清算监管

parameters:
  - name: topic
    type: string
    required: true
    description: 政策主题/关键词
    aliases: [主题, 政策, 关键词]

  - name: region
    type: string
    required: false
    description: 目标地域
    aliases: [地域, 地区, 城市]

  - name: focus
    type: string
    required: false
    description: 分析重点领域
    aliases: [重点, 领域]

calls:
  - serp-api  # 搜索外部信息
  - minimax-docx  # 生成文档

output:
  format: markdown
  template: 政策简报模板.md

validation:
  required_fields: [topic]
  max_length: 5000
---

# 技能内容（原有 Markdown）

...
```

---

## 字段说明

### skill (必需)

| 字段 | 类型 | 说明 |
|------|------|------|
| name | string | 技能唯一标识符 |
| version | string | 版本号 (语义化) |
| description | string | 技能描述 |

### triggers (推荐)

触发短语列表，用于自动路由匹配。

- 支持精确匹配
- 支持模糊匹配（部分包含）
- 优先级高于关键词匹配

### parameters (可选)

技能接受的参数定义。

| 字段 | 类型 | 说明 |
|------|------|------|
| name | string | 参数名 |
| type | string | 类型: string, integer, boolean, array |
| required | boolean | 是否必需 |
| description | string | 参数描述 |
| aliases | array | 别名列表 |
| default | any | 默认值 |

### calls (可选)

技能链调用列表，指定需要依次调用的依赖技能。

- 按顺序执行
- 前一个技能的输出作为下一个的输入

### output (可选)

输出格式定义。

| 字段 | 类型 | 说明 |
|------|------|------|
| format | string | 格式: markdown, json, html, pdf |
| template | string | 模板文件路径 |

### validation (可选)

验证规则。

| 字段 | 类型 | 说明 |
|------|------|------|
| required_fields | array | 必需字段列表 |
| max_length | integer | 最大长度 |

---

## 解析优先级

1. 优先解析 YAML front-matter
2. 如果无 front-matter，回退到原有 Markdown 解析
3. 兼容现有不包含元数据的技能文件

---

## 工具支持

解析器：`scripts/skill_parser.py`

```bash
# 列出所有技能
python3 scripts/skill_parser.py --list

# 解析单个技能
python3 scripts/skill_parser.py parse policy-pbc

# 匹配触发短语
python3 scripts/skill_parser.py match "分析支付监管"
```

---

## 版本历史

| 版本 | 日期 | 变更 |
|------|------|------|
| v1.0 | 2026-02-27 | 初始版本 |
