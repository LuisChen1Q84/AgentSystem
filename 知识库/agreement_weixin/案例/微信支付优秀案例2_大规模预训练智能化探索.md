**2025微信支付优秀案例**

**微信支付大规模预训练最新前沿探索**

一、**背景介绍**

当前人工智能生成式预训练技术已在文本、图像、音频等内容模态领域取得显著突破，以大语言模型（LLM）为代表的技术体系，能够从海量语料中提炼"世界知识"，实现高效的语义理解与内容生成。然而，作为数字世界中另一类至关重要且规模庞大的数据模态------用户行为序列[^1]，其体系化的预训练研究仍处于起步阶段。与描述 "世界如何呈现"的内容模态不同，行为序列动态地记录了用户"如何与世界交互"的"行动知识"，这构成了世界知识中一个至关重要的维度。然而，现有技术多局限于为特定场景构建孤立的分析模型，缺乏一种能够从海量、稀疏、高噪的用户行为序列数据中自主学习通用规律，并可向下游多种任务复用的基础能力。为解决上述问题，需要从为单一任务"量身定制"专用模型向构建具备泛化能力的统一"行为认知基座"演进。基于此：研究团队提出PANTHER（Pattern AttentioN Transformer with Hybrid User ProfilER）行为预训练技术方案，进行创造性探索。相关情况如下：

二、生成式行为序列预训练技术行业现状分析

（一）蓬勃兴起，研究如雨后春笋

自2023年起，生成式预训练技术逐渐被引入用户行为序列分析领域，旨在从复杂动态数据中挖掘深层行为模式，以增强对用户意图的识别与预测能力。该方向受到学术界与工业界的广泛关注，​​截至2025年，全球已有至少30余家知名机构与企业（如Meta、Amazon、腾讯等）​​ 在此方向展开布局，覆盖推荐系统、金融风控、电商营销、消费信贷等多个关键场景。​​相关高水平研究论文累计已超过200篇​​，显示出该方向强劲的技术活力与创新潜力。

（二）特定业务优化为主，跨任务泛化能力不足

2024年Meta公司发布的HSTU模型是该方向上的重要进展，其将推荐任务重构为预测"用户下一个可能交互的项目"的序列生成问题，并提出了专门针对高基数、长序列场景设计的HSTU架构，在可扩展性方面展现出优于通用Transformer的潜力。此后，快手于2025年6月发布OneRec技术报告，是对该范式的一种工业化尝试，其重点在于构建兼顾召回与排序的端到端生成式框架。尽管上述方法在端到端建模与规模化训练方面具备一定优势，其核心目标仍局限于"用户下一个交互项目预测"，在构建跨场景、多任务通用的行为理解基座方面存在明显不足。需要指出的是，HSTU目前仅公开了其自报告的A/B测试结果与有限场景的部署情况；OneRec亦处于主场景的初步落地阶段，距离全面替代现有系统、形成通用行为基础模型仍有较大差距。此外，这类方法在行为事件表示上多依赖物品ID等离散标识，难以有效建模支付场景中金额、时间、上下文等多维连续特征，其架构也多为特定业务优化，在跨任务泛化与工程落地效率方面存在局限。

（三）实验阶段多，大规模落地少

总体来看，尽管技术研究高度活跃，受限于高计算成本与通用性不足等因素，多数成果，如Meta的HSTU，仍处于实验阶段或特定场景验证期，尚未在真实的大规模业务中实现广泛落地，在支付领域开展针对性创新、构建兼顾通用性、高效性与可落地性的行为认知基座，更是存在较大难度。

三、**方案概述及创新亮点**

![图示 描述已自动生成](media/image1.png){width="6.299305555555556in" height="3.71875in"}

微信支付自2023年起率先开展生成式行为预训练技术的系统性研究。针对支付场景（如信贷风控、商户风险管理）中存在的样本稀疏、传统模型泛化能力不足，以及多业务间数据与认知隔离等长期挑战，研究团队致力于借助生成式技术构建新一代基础架构。通过持续的技术攻关，已在关键方法创新、大规模业务落地以及学术价值认可等领域取得了一系列初步成果。

关键技术创新要点

1.通过结构化分词技术构建行为序列基本单元。传统的用户行为分析通常依赖单一ID或标签，难以全面表达支付交易中的多维信息。结构化分词技术通过将支付工具、金额、场景、时间等关键信息整合为语义丰富的结构化单元（如"晚上8点刷卡50元院线影城"），具有如下优势：

一是显著提升理解与预测精度。结构化分词使得模型能够深入理解每笔交易的具体细节，从而更准确地捕捉到交易背后的行为模式，提高下一次行为预测的命中率。二是更高效适应稀疏与冷启动。把新用户或少见交易拆解为可组合的结构化单元，即使样本很少也能类比到已知模式，缓解长尾与冷启动问题。三是有效提高计算效率与稳定性。结构化单元有助于减少重复与噪声，特征更可控，训练与推理更快、在线波动更小。

2.设计序列模式识别模块精准理解用户支付行为。用户支付常呈现紧密相连的操作链条（如"充值→转账→提现""购票→订酒店→租车"）。这类连续行为携带因果逻辑与语义线索，是理解消费习惯与交易逻辑的关键。传统自注意力在长序列中对相邻强依赖不够敏感，细粒度模式识别不足，进而限制预测与解释精度。 为克服传统机制局限，团队设计了序列模式识别模块（SPRM, Sequence Pattern Recognition Module），该模块设计难点在于要让模型在不依赖人工标注的情况下，同时理解交易序列中的时间逻辑和语义规律------这需要在算法中平衡"理解深度"和"计算可行性"，属于序列建模领域长期公认的技术难题。其核心技术创新为：

一是局部模式聚合。SPRM引入深度空洞卷积结构，通过不同尺度的卷积核在时间轴上滑动，有效聚合相邻交易的局部特征，生成更紧凑的序列表示，以使模型能够识别出多层次的消费模式，从短期连贯操作到长期行为习惯均能被捕捉。二是原型驱动的模式匹配。通过构建可学习"消费原型"（如"周末休闲""工作通勤"）作为结构化锚点；将实际序列与原型计算相似度并加权融合，实现对已知模式的主动对齐，增强方向性与可解释性，可有效提升小样本/长尾场景的稳健性。

3.融合动静态特征与对比学习机制，构建通用用户表征，提升支付行为预测精度

为构建统一、可复用的用户行为表征并实现精准的支付行为预测以及，PANTHER模型提出了一种融合动静态特征与对比学习机制的预训练方法，其难度在不依赖大规模标注的情况下，让模型同时学习"个体差异"与"群体共性"，并在统一表征空间中平衡二者。这在AI表征学习中长期被视为挑战。具体技术细节如下：

一是高效融合动静态特征生成紧凑表征。模型将用户的静态属性（如年龄、性别、地理位置等）与动态交易序列（如时间、金额、类型等）联合嵌入，生成统一的低维表征向量。该向量在一个共享空间中同时表达用户的身份特征与行为规律，使模型既能区分不同用户，又具备跨场景泛化能力。更重要的是，这一表征可直接供下游任务调用，成为可移植的标准化特征，显著提升了模型在工程部署中的实用性。二是基于对比学习优化表征空间。为应对数据稀疏与用户异质性带来的挑战，PANTHER引入对比学习机制，注入"背景相似用户具有相近行为偏好"的先验知识。在嵌入空间中，模型通过拉近相似背景用户的表征，强化群体行为模式的聚合能力。例如，相同年龄层或地理区域的用户在特定场景下往往呈现相似支付习惯，模型通过该结构化对齐，能够有效利用群体信息弥补个体数据不足，从而在新用户与长尾场景下保持预测稳健性与一致性。

4.通过设计"离线预训练‑在线轻推理"的混合架构，实现预训练模型大规模部署

尽管生成式大模型具备强大的序列建模能力，但其复杂结构和自回归推理机制导致高计算延迟和资源消耗，难以满足支付业务的高并发和低延迟需求，直接部署可能引发瓶颈和运维难题。为平衡建模能力与系统性能，PANTHER提出了生成-判别混合框架，解耦生成与判别模型，保留生成式模型表达力并大幅降低在线推理负担。设计难点在于如何通过模型训练、数据同步与系统调度的多层协同，实现两类模型的特征映射与同步更新，确保语义一致性和系统稳定性。具体技术细节如下：

一是离线预训练阶段。这一阶段充分利用大规模历史数据，在无实时计算压力下完成深度表征提取，为在线模块提供高质量知识支撑。具体而言，系统首先在离线环境中利用海量行为数据进行生成式预训练，基于Transformer架构建模用户的长时序行为规律，输出两类核心成果：a.用户画像嵌入：通过融合用户静态属性与动态交易行为，生成统一的低维画像向量，为后续在线推理提供标准化输入。b. 行为先验分布：在海量历史数据上形成用户"正常交易"的参考基线，下游风控、信贷等业务场景只需对比实时行为与该基线的偏离程度，就能更早识别异常并获得稳定、可解释的特征。 二是在线轻量推理阶段。在线服务部分采用轻量级判别模型，依托离­­­­线生成的画像与先验进行实时风险评估。主要流程包括：a.快速加载缓存画像与上下文信息。通过将离线生成的特征周期性同步至线上特征库，推理时系统可直接从缓存调用，减少数据I/O延迟。b.毫秒级判别推理。在融合用户画像与当前交易上下文后再进行实时预测，以在毫秒级内完成风险评分，实现并满足金融场景对低延迟与高并发的要求。

四、**部分落地应用探索及国际评价**

（一）跨领域验证PANTHER算法的可通用性

团队在多个公开基准数据集上系统性地验证了PANTHER模型的先进性与通用性。实验结果表明，该模型在预训练质量与多项关键下游任务（如欺诈检测、推荐预测）中均展现出显著优势，其跨领域迁移能力得到进一步证实。核心对比如下：实验选取了Transformer、SASRec及HSTU等作为基线模型，并在支付金融（如微信支付数据集、CCT信用卡交易数据集、MBD-mini）与通用推荐（如MovieLens-1M、Yelp）等多类场景中进行测试。在下一行为预测任务上，PANTHER在HR@1指标上全面提升，在微信支付、CCT、MovieLens-1M和Yelp数据集上分别相对提升25.56%、15.20%、21.76%与9.17%。此外，在混合欺诈检测任务中，PANTHER在CCT数据集上将基准模型TabBERT-MLP的召回率（正确识别欺诈的比例）提升19.9%；在Yelp推荐任务中，将DCN基准的NDCG@5指标（归一化累积增益，评估推荐列表质量）提升29.6%。为进一步验证其泛化性，我们采用"预训练-微调"范式，将基于微信支付数据训练的PANTHER模型迁移至CCT与MBD-mini数据集。结果显示，相较于从零训练，微调后的模型性能平均提升10.43%--13.76%，证明PANTHER所学习的行为表征具备较强的领域迁移潜力，为构建通用行为认知基座提供了实证支持。

（二） 在微信支付部分业务实现规模化部署，验证防控实效

![图片包含 QR 代码 描述已自动生成](media/image2.png){width="1.5572922134733158in" height="2.7721095800524935in"}

1.反欺诈识别领域实现风险交易识别精度大幅提升 。在反欺诈业务实践中，PANTHER行为预训练技术从用户历史交易序列中提取长期行为特征，建立用户行为基准；针对特定交易，通过融合该交易上下文与行为嵌入，实现对支付意图的联合建模，通过动态计算当前交易与预期行为模式的偏离度进行风险评估，偏离度越高，风险评分相应提升，从而增强对异常交易的识别灵敏度。线上测试结果显示，针对最高风险等级（约占交易总量0.1%）可疑交易，该系统识别出的欺诈交易数量较研究团队基线提升38.6%。结果表明，PANTHER技术在未影响用户使用体验前提下，显著提升了对高风险、低频欺诈交易的识别精度，同时有效降低了误报率。

![图示 描述已自动生成](media/image3.png){width="1.9784087926509186in" height="3.182292213473316in"}

2.商户风险精准预警与治理水平大幅提升。在商户日常风险监测与治理中，PANTHER行为预训练技术基于统一的行为认知模型，通过量化用户与商户间的行为一致性，能够在多个用户的交易行为普遍偏离其个体基准时，及时识别出商户异常风险，实现从"事后追溯"向"事前预警"的转变，对高风险商户的识别准确率提升至76%。2025年3月到10月累计精准识别并处置风险商户3000余户 。

（三）得到国际学术会议认可

相关核心成果已通过国际同行评议，2025年10月，被人工智能全球顶级会议NeurIPS 2025接收。研究团队将借此平台与国内外学界及业界交流技术成果，分享中国在生成式AI与金融科技融合方面的实践。

五、未来展望

展望未来，团队将持续深耕行为序列预训练技术，并积极探索其与大语言模型的融合创新，致力于为支付产业构建更安全、高效、智能的技术基础。我们相信，这一探索不仅有助于提升商业效能，也将在更广层面产生积极的社会价值。在技术演进上，我们将着力于以下方向：在基础层面，通过持续增强行为认知精度，进一步筑牢金融安全防线，为保护用户资产安全提供更强大的技术保障；在能力层面，探索基于行为理解的动态策略生成与用户意图解析，助力提升金融服务的自动化与普惠化水平；在创新层面，积极关注技术与物联网、政务数字化等趋势的结合点，为构建更加便捷、可信的数字社会，为推动支付数字化、智能化转型取得更大成效贡献力量。

[^1]: 用户行为序列是指用户在数字平台上产生的、按时间戳排序的原子行为单元所组成的有序列表。每个原子行为单元由一个行为类型（如支付、充值、删除）和一组描述该行为细节的属性键值对（如金额、对象、设备等）共同定义。
